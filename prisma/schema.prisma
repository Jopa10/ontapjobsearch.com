// This is your Prisma schema file for Ontap Job Search Platform
// Database: PostgreSQL with comprehensive models for job matching platform

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Job listings model
model Job {
  id                String        @id @default(uuid())
  jobTitle          String        @map("job_title")
  jobLocation       String        @map("job_location")
  jobDescription    String        @db.Text @map("job_description")
  jobCategory       String        @map("job_category")
  jobType           String        @map("job_type") // Full-time, Part-time, Contract, etc.
  companyName       String        @map("company_name")
  companyUrl        String?       @map("company_url")
  companyLogo       String?       @db.Text @map("company_logo")
  jobApplicationUrl String        @map("job_application_url") // CTA URL
  otherDetails      String?       @db.Text @map("other_details")
  isPublished       Boolean       @default(true) @map("is_published")
  createdAt         DateTime      @default(now()) @map("created_at")
  updatedAt         DateTime      @updatedAt @map("updated_at")
  applications      Application[]

  @@index([jobTitle])
  @@index([jobLocation])
  @@index([jobCategory])
  @@index([jobType])
  @@index([companyName])
  @@index([createdAt])
  @@map("jobs")
}

// Admin users model
model Admin {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String // Hashed with bcrypt
  name      String
  role      String   @default("admin") // admin, super_admin, etc.
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("admins")
}

// Application tracking model - tracks when users click "Apply Now"
model Application {
  id             String   @id @default(uuid())
  jobId          String   @map("job_id")
  trackingCookie String   @map("tracking_cookie") // UUID to track applicant
  timestamp      DateTime @default(now())
  job            Job      @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@index([jobId])
  @@index([trackingCookie])
  @@index([timestamp])
  @@map("applications")
}
